{"version":3,"sources":["/tools/isobuild/minifier-plugin.js"],"names":["buildmessage","buildPluginModule","require","InputFile","source","options","_source","_arch","arch","_minifiedFiles","getContentsAsBuffer","contents","getPathInPackage","Error","getPackageName","getSourceHash","hash","getArch","error","message","sourcePath","line","column","func","relPath","getPathInBundle","file","undefined","targetPath","getSourceMap","sourceMap","JsFile","addJavaScript","self","push","data","path","CssFile","addStylesheet"],"mappings":";;;AAAA,OAAOA,YAAP,MAAyB,0BAAzB;AACA,IAAMC,oBAAoBC,QAAQ,mBAAR,CAA1B;;IAEMC,S;;;AACJ,qBAAYC,MAAZ,EAAkC;AAAA,QAAdC,OAAc,uEAAJ,EAAI;;AAAA;;AAAA,iDAChC,gCADgC;;AAGhC,UAAKC,OAAL,GAAeF,MAAf;AACA,UAAKG,KAAL,GAAaF,QAAQG,IAArB;AACA,UAAKC,cAAL,GAAsB,EAAtB;AALgC;AAMjC;;sBAEDC,mB,kCAAsB;AACpB,WAAO,KAAKJ,OAAL,CAAaK,QAAb,EAAP;AACD,G;;sBACDC,gB,+BAAmB;AACjB,UAAM,IAAIC,KAAJ,CAAU,4CAAV,CAAN;AACD,G;;sBACDC,c,6BAAiB;AACf,UAAM,IAAID,KAAJ,CAAU,4CAAV,CAAN;AACD,G;;sBACDE,a,4BAAgB;AACd,WAAO,KAAKT,OAAL,CAAaU,IAAb,EAAP;AACD,G;;sBACDC,O,sBAAU;AACR,WAAO,KAAKV,KAAZ;AACD,G;;sBAEDW,K,wBAAiD;AAAA,QAA1CC,OAA0C,QAA1CA,OAA0C;AAAA,QAAjCC,UAAiC,QAAjCA,UAAiC;AAAA,QAArBC,IAAqB,QAArBA,IAAqB;AAAA,QAAfC,MAAe,QAAfA,MAAe;AAAA,QAAPC,IAAO,QAAPA,IAAO;;AAC/C,QAAMC,UAAU,KAAKC,eAAL,EAAhB;AACAzB,iBAAakB,KAAb,CAAmBC,WAAY,qBAAqBK,OAApD,EAA8D;AAC5DE,YAAMN,cAAcI,OADwC;AAE5DH,YAAMA,OAAOA,IAAP,GAAcM,SAFwC;AAG5DL,cAAQA,SAASA,MAAT,GAAkBK,SAHkC;AAI5DJ,YAAMA,OAAOA,IAAP,GAAcI;AAJwC,KAA9D;AAMD,G;;AAED;;;;;;;sBAKAF,e,8BAAkB;AAChB,WAAO,KAAKnB,OAAL,CAAasB,UAApB;AACD,G;;AAED;;;;;;;sBAKAC,Y,2BAAe;AACb,WAAO,KAAKvB,OAAL,CAAawB,SAApB;AACD,G;;;EAnDqB7B,kBAAkBE,S;;AAsD1C,WAAa4B,MAAb;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AACE;AACA;AACA;AACA;AAJF,mBAKEC,aALF,0BAKgB3B,OALhB,EAKyB;AACrB,QAAM4B,OAAO,IAAb;AACAA,SAAKxB,cAAL,CAAoByB,IAApB,CAAyB;AACvBC,YAAM9B,QAAQ8B,IADS;AAEvBL,iBAAWzB,QAAQyB,SAFI;AAGvBM,YAAM/B,QAAQ+B;AAHS,KAAzB;AAKD,GAZH;;AAAA;AAAA,EAA4BjC,SAA5B;;AAeA,WAAakC,OAAb;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AACE;AACA;AACA;AACA;AAJF,oBAKEC,aALF,0BAKgBjC,OALhB,EAKyB;AACrB,SAAKI,cAAL,CAAoByB,IAApB,CAAyB;AACvBC,YAAM9B,QAAQ8B,IADS;AAEvBL,iBAAWzB,QAAQyB,SAFI;AAGvBM,YAAM/B,QAAQ+B;AAHS,KAAzB;AAKD,GAXH;;AAAA;AAAA,EAA6BjC,SAA7B","file":"tools/isobuild/minifier-plugin.js.map","sourcesContent":["import buildmessage from '../utils/buildmessage.js';\nconst buildPluginModule = require('./build-plugin.js');\n\nclass InputFile extends buildPluginModule.InputFile {\n  constructor(source, options = {}) {\n    super();\n\n    this._source = source;\n    this._arch = options.arch;\n    this._minifiedFiles = [];\n  }\n\n  getContentsAsBuffer() {\n    return this._source.contents();\n  }\n  getPathInPackage() {\n    throw new Error(\"Compiled files don't belong to any package\");\n  }\n  getPackageName() {\n    throw new Error(\"Compiled files don't belong to any package\");\n  }\n  getSourceHash() {\n    return this._source.hash();\n  }\n  getArch() {\n    return this._arch;\n  }\n\n  error({message, sourcePath, line, column, func}) {\n    const relPath = this.getPathInBundle();\n    buildmessage.error(message || ('error minifying ' + relPath), {\n      file: sourcePath || relPath,\n      line: line ? line : undefined,\n      column: column ? column : undefined,\n      func: func ? func : undefined\n    });\n  }\n\n  /**\n   * @summary Returns the path of the compiled file in the bundle.\n   * @memberof InputFile\n   * @returns {String}\n   */\n  getPathInBundle() {\n    return this._source.targetPath;\n  }\n\n  /**\n   * @summary Returns the source-map associated with the file.\n   * @memberof InputFile\n   * @returns {String}\n   */\n  getSourceMap() {\n    return this._source.sourceMap;\n  }\n}\n\nexport class JsFile extends InputFile {\n  // - data\n  // - sourceMap\n  // - path\n  // - hash?\n  addJavaScript(options) {\n    const self = this;\n    self._minifiedFiles.push({\n      data: options.data,\n      sourceMap: options.sourceMap,\n      path: options.path\n    });\n  }\n}\n\nexport class CssFile extends InputFile {\n  // - data\n  // - sourceMap\n  // - path\n  // - hash?\n  addStylesheet(options) {\n    this._minifiedFiles.push({\n      data: options.data,\n      sourceMap: options.sourceMap,\n      path: options.path\n    });\n  }\n}\n\n"]}